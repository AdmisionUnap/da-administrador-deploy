{"version":3,"sources":["webpack:///./src/views/registro_pago/RegistroPago.vue","webpack:///src/views/registro_pago/RegistroPago.vue","webpack:///./src/views/registro_pago/RegistroPago.vue?16a6","webpack:///./src/views/registro_pago/RegistroPago.vue?82d9"],"names":["render","_vm","this","_c","_self","staticClass","get_auth","group","on","$event","set_pagos","_v","agregar_nuevos_pagos","_e","attrs","item_selected","dialog","mostrar","read_txt","lineas","length","_s","fecha","subirPagos","lineas_existentes","actualizar","edit","close_dialog","staticRenderFns","List","Add","components","data","admisionData","is_extemporaneo","computed","SedeText","methods","fechaExtemporaneo","refresh_reactivo","sede","color","reader","resolve","tipo_doc","title","text","concepto","num_doc","console","num_operacion","monto","decimales","nombre","aux","repetido","is_exonerado","documento_referencial","monto_full","loading","element","descripcion","num_ticket","dni","data_envio","item","component"],"mappings":"yHAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,iBAAiB,CAACF,EAAG,MAAM,CAACE,YAAY,QAAQ,CAAwB,iBAAtBJ,EAAIK,SAASC,MAA0BJ,EAAG,MAAM,CAACE,YAAY,QAAQ,CAACF,EAAG,YAAY,CAACE,YAAY,qBAAqBG,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOR,EAAIS,eAAe,CAACT,EAAIU,GAAG,mCAAmCR,EAAG,YAAY,CAACE,YAAY,qBAAqBG,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOR,EAAIW,0BAA0B,CAACX,EAAIU,GAAG,iCAAiC,GAAGV,EAAIY,KAAKV,EAAG,YAAY,CAACE,YAAY,qBAAqBS,MAAM,CAAC,OAAS,IAAIN,GAAG,CAAC,MAAQ,SAASC,GAAQR,EAAIc,cAAgB,GACloBd,EAAIe,QAAS,KAAS,CAACf,EAAIU,GAAG,yBAAyB,GAAKV,EAAIgB,QAAwjBhB,EAAIY,KAAnjBV,EAAG,MAAM,CAACE,YAAY,2DAA2D,CAACF,EAAG,MAAM,CAACA,EAAG,IAAI,CAACF,EAAIU,GAAG,cAAcR,EAAG,QAAQ,CAACE,YAAY,OAAOS,MAAM,CAAC,KAAO,OAAO,OAAS,QAAQN,GAAG,CAAC,OAASP,EAAIiB,cAAejB,EAAIkB,OAAOC,OAAS,EAAGjB,EAAG,MAAM,CAACA,EAAG,KAAK,CAACE,YAAY,sCAAsC,CAACJ,EAAIU,GAAG,SAASV,EAAIoB,GAAGpB,EAAIkB,OAAO,GAAGG,OAAO,SAASrB,EAAIY,KAAKV,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACF,EAAG,YAAY,CAACW,MAAM,CAAC,OAAS,IAAIN,GAAG,CAAC,MAAQP,EAAIsB,aAAa,CAACpB,EAAG,IAAI,CAACE,YAAY,yBAAyBJ,EAAIU,GAAG,oBAAoB,OAAgBR,EAAG,OAAO,CAACW,MAAM,CAAC,SAAWb,EAAIkB,OAAO,WAAalB,EAAIuB,kBAAkBJ,OAAO,WAAanB,EAAIwB,YAAYjB,GAAG,CAAC,KAAOP,EAAIyB,KAAK,YAAc,SAASjB,GAAQR,EAAIwB,YAAa,MAAUtB,EAAG,MAAM,CAACW,MAAM,CAAC,OAASb,EAAIe,OAAO,cAAgBf,EAAIc,eAAeP,GAAG,CAAC,YAAcP,EAAI0B,aAAa,WAAa,SAASlB,GAAQR,EAAIwB,YAAa,OAAU,IAE1+BG,EAAkB,G,wBCsEtB,MAAMC,EAAO,IAAM,gDACbC,EAAM,IAAM,gDAEH,OACfC,YAAAF,OAAAC,OACAE,OACA,OACAb,UACAK,qBACAP,WACAF,iBACAC,UACAS,cACAQ,gBACAC,qBAIAC,UACA7B,WACA,6CAGA8B,WACA,yDACA,KAIA,sBACA,iBACA,oBAGAC,SACA,oBAEA,WAAAL,SAAA,uBACA,uBACA,wBAAAM,GAAA,kBACA,aACA,OACA,0BAIAC,mBACA,kDAGAZ,eACA,eACA,uBAGAD,QACA,wBACA,qBACA,gBAGAd,uBACA,eACA,0BACA,iBAGA,kBACA,IACA,gBACA,eACA,gCACA,sCAAA4B,qBACA,wBACA,YAKA,kBACA,0BACAC,kBAGA,IACA,YACA,gBACA,eACA,qBACAC,oBACA,eACAC,MAEAD,iCAIA,aAGA,kBAFA,eAGAE,iBAEA,oBAEA,YACA,uBACAC,gCACAC,iCACAL,kBAOAtB,cACA4B,iBACA,mCAKA,GAJAC,iBACAA,WACAA,gBAEA,0BACAC,4BACAL,iBACAtB,iBAEA,qBACA,eACA,eACAA,mBAEA4B,iBACAC,iBACA,QACAC,iBACAD,gBACAA,0BACAE,mBAEAA,WACAA,eACA,mBACA,yBAGAA,KACAC,cACAD,kBAGAA,WAEA,kBACAT,WACAI,UACA1B,QACA6B,QACAE,SACAH,gBACAK,YACAC,gBACAC,yBACAC,oBAOA,UAEC,QACDC,UACA,4BAIA,mBACA,yBAMA,YALA,uBACAd,0BACAC,4BACAL,iBAKA,0BACAA,kBAGA,SAEA,wBACA,QACAmB,6CACA,OACAC,4BACAV,cACAW,2BACAxC,cACAyC,cACAV,gBACAb,yBACAkB,wBACAxB,mBAGA8B,YAGA,IACA,WAAAhC,SAAA,mCAYA,GAVA,wCACA,4BACA,uCACAiC,kCAEA,OACA,8BAIA,YAMA,YALA,uBACApB,0BACAC,sCACAL,iBAKA,uBACAI,0BACAC,+CACAL,kBAEA,SACA,uBACAI,0BACAC,kDACAL,iBAEA,QACAkB,cChUqW,I,YCOjWO,EAAY,eACd,EACAlE,EACA4B,GACA,EACA,KACA,WACA,MAIa,aAAAsC,E","file":"js/chunk-2d0d43c7.e2c0949d.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('div',{staticClass:\"flex flex-col\"},[_c('div',{staticClass:\"flex\"},[(_vm.get_auth.group == 'administrador')?_c('div',{staticClass:\"flex\"},[_c('vs-button',{staticClass:\"focus:outline-none\",on:{\"click\":function($event){return _vm.set_pagos()}}},[_vm._v(\" Mostrar Todos los Registros \")]),_c('vs-button',{staticClass:\"focus:outline-none\",on:{\"click\":function($event){return _vm.agregar_nuevos_pagos()}}},[_vm._v(\" Agregar Nuevos Registros \")])],1):_vm._e(),_c('vs-button',{staticClass:\"focus:outline-none\",attrs:{\"danger\":\"\"},on:{\"click\":function($event){_vm.item_selected = {};\n          _vm.dialog = true;}}},[_vm._v(\" Pagos Exonerados \")])],1),(!_vm.mostrar)?_c('div',{staticClass:\"flex flex-col lg:flex-row justify-between p-3 shadow-lg\"},[_c('div',[_c('p',[_vm._v(\"Importar\")]),_c('input',{staticClass:\"mt-3\",attrs:{\"type\":\"file\",\"accept\":\".txt\"},on:{\"change\":_vm.read_txt}})]),(_vm.lineas.length > 0)?_c('div',[_c('h1',{staticClass:\"font-medium text-3xl text-gray-300\"},[_vm._v(\" Dia: \"+_vm._s(_vm.lineas[0].fecha)+\" \")])]):_vm._e(),_c('div',{staticClass:\"mt-3 lg:mt-0\"},[_c('vs-button',{attrs:{\"square\":\"\"},on:{\"click\":_vm.subirPagos}},[_c('i',{staticClass:\"fas fa-arrow-up mr-2\"}),_vm._v(\" Subir pagos \")])],1)]):_vm._e()]),_c('list',{attrs:{\"dataList\":_vm.lineas,\"countExist\":_vm.lineas_existentes.length,\"actualizar\":_vm.actualizar},on:{\"edit\":_vm.edit,\"actualizado\":function($event){_vm.actualizar = false}}}),_c('add',{attrs:{\"dialog\":_vm.dialog,\"item_selected\":_vm.item_selected},on:{\"closedialog\":_vm.close_dialog,\"actualizar\":function($event){_vm.actualizar = true}}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <div class=\"flex flex-col\">\n      <div class=\" flex\">\n        <div class=\" flex\" v-if=\"get_auth.group == 'administrador'\">\n          <vs-button @click=\"set_pagos()\" class=\" focus:outline-none\">\n            Mostrar Todos los Registros\n          </vs-button>\n\n          <vs-button\n              @click=\"agregar_nuevos_pagos()\"\n              class=\" focus:outline-none\"\n          >\n            Agregar Nuevos Registros\n          </vs-button>\n        </div>\n\n        <vs-button\n            @click=\"\n            item_selected = {};\n            dialog = true;\n          \"\n            danger\n            class=\" focus:outline-none\"\n        >\n          Pagos Exonerados\n        </vs-button>\n      </div>\n\n      <div\n          v-if=\"!mostrar\"\n          class=\" flex flex-col lg:flex-row justify-between p-3 shadow-lg\"\n      >\n        <div>\n          <p>Importar</p>\n          <input class=\" mt-3\" type=\"file\" accept=\".txt\" @change=\"read_txt\"/>\n        </div>\n\n        <div v-if=\"lineas.length > 0\">\n          <h1 class=\" font-medium text-3xl text-gray-300\">\n            Dia: {{ lineas[0].fecha }}\n          </h1>\n        </div>\n\n        <div class=\" mt-3 lg:mt-0\">\n          <vs-button square @click=\"subirPagos\">\n            <i class=\"fas fa-arrow-up mr-2\"></i>\n            Subir pagos\n          </vs-button>\n        </div>\n      </div>\n    </div>\n\n    <list\n        :dataList=\"lineas\"\n        :countExist=\"lineas_existentes.length\"\n        @edit=\"edit\"\n        :actualizar=\"actualizar\"\n        @actualizado=\"actualizar = false\"\n    />\n\n    <add\n        :dialog=\"dialog\"\n        @closedialog=\"close_dialog\"\n        :item_selected=\"item_selected\"\n        @actualizar=\"actualizar = true\"\n    />\n  </div>\n</template>\n\n<script>\nimport axios from \"@//plugins//axios.js\";\n\nconst List = () => import(\"./components/List.vue\");\nconst Add = () => import(\"./components/Add.vue\");\n\nexport default {\n  components: {List, Add},\n  data() {\n    return {\n      lineas: [],\n      lineas_existentes: [],\n      mostrar: true,\n      item_selected: {},\n      dialog: false,\n      actualizar: false,\n      admisionData: {},\n      is_extemporaneo: false,\n    };\n  },\n\n  computed: {\n    get_auth() {\n      return this.$store.getters[\"auth/get_auth\"];\n    },\n\n    SedeText() {\n      if (this.get_auth.group == \"sede\") return this.get_auth.username;\n      return \"\";\n    },\n  },\n\n  async mounted() {\n    await this.set_pagos();\n    this.getAdmision();\n  },\n\n  methods: {\n    async getAdmision() {\n      // aun no se sabe si esta bien\n      const {data} = await axios.get(\"admision\");\n      this.admisionData = data[0];\n      const {fechaExtemporaneo} = this.admisionData;\n      const fechaActual = Date().now;\n      if (fechaExtemporaneo == fechaActual) {\n        this.is_extemporaneo = true;\n      }\n    },\n\n    refresh_reactivo() {\n      this.lineas = this.$store.getters[\"pago/get_pago\"];\n    },\n\n    close_dialog() {\n      this.dialog = false;\n      this.item_selected = {};\n    },\n\n    edit(e) {\n      this.item_selected = null;\n      this.item_selected = e;\n      this.dialog = true;\n    },\n\n    agregar_nuevos_pagos() {\n      this.lineas = [];\n      this.lineas_existentes = [];\n      this.mostrar = false;\n    },\n\n    async set_pagos() {\n      try {\n        this.mostrar = true;\n        this.lineas = [];\n        this.lineas_existentes = [];\n        await this.$store.dispatch(\"pago/set_pago\", {sede: this.SedeText});\n        this.refresh_reactivo();\n      } catch (error) {\n        //\n      }\n    },\n\n    async read_txt(e) {\n      const loading = this.$vs.loading({\n        color: \"success\",\n      });\n\n      try {\n        const fun = () => {\n          return new Promise((resolve) => {\n            let input = e.target;\n            var reader = new FileReader();\n            reader.onload = function () {\n              let text = reader.result;\n              resolve(text);\n            };\n            reader.readAsText(input.files[0]);\n          });\n        };\n\n        await fun().then((res) => {\n          this.lineas = [];\n\n          let tipo_doc, num_doc, fecha, monto, concepto, nombre, num_operacion;\n          tipo_doc = num_doc = fecha = monto = concepto = nombre = num_operacion = \"\";\n\n          let lineas = res.split(\"\\n\");\n\n          if (lineas.length <= 0) {\n            this.$vs.notification({\n              title: \"Cargar Archivo de Texto\",\n              text: \"El txt no tiene datos! ðŸ˜¢\",\n              color: \"warning\",\n            });\n            return;\n          }\n\n          \n\n          lineas.forEach((element) => {\n            concepto = element.slice(35, 43); //8\n            const condicion = parseInt(element.slice(112, 113));\n            num_doc = element.slice(47, 62); //15\n            num_doc = num_doc.trim();\n            num_doc = num_doc.slice(7, 15);\n\n            if (parseInt(concepto) === 574 && condicion === 2) {\n              console.log(\"lineas\", concepto, condicion, num_doc);\n              tipo_doc = element.slice(25, 27); //2\n              fecha = element.slice(79, 87); //8\n              //\n              const anio = fecha.slice(0, 4);\n              const mes = fecha.slice(4, 6);\n              const dia = fecha.slice(6, 8);\n              fecha = `${anio}-${mes}-${dia}`;\n              //\n              num_operacion = element.slice(18, 25); //8\n              monto = element.slice(62, 77);\n              let decimales = 0;\n              decimales = monto.slice(13, 15);\n              monto = monto.slice(1, 13);\n              monto = parseFloat(`${monto}.${decimales}`);\n              nombre = element.slice(121, 156); //35\n              //\n              nombre = nombre.trim();\n              nombre = nombre.split(\" \");\n              let aux = nombre.filter((item) => {\n                if (item.length > 0) return item;\n              });\n\n              nombre = \"\";\n              aux.forEach((element) => {\n                nombre += element.trim() + \" \";\n              });\n\n              nombre = nombre.trim();\n\n              this.lineas.push({\n                tipo_doc,\n                num_doc,\n                fecha,\n                monto,\n                nombre,\n                num_operacion,\n                repetido: false,\n                is_exonerado: false,\n                documento_referencial: \"\",\n                monto_full: monto,\n              });\n\n              //\n            }\n          });\n        });\n      } catch (error) {\n        //\n      } finally {\n        loading.close();\n        this.lineas_existentes = [];\n      }\n    },\n\n    async subirPagos() {\n      if (this.lineas.length <= 0) {\n        this.$vs.notification({\n          title: \"Subir al servidor\",\n          text: \"No existen datos! ðŸ˜¢\",\n          color: \"danger\",\n        });\n        return;\n      }\n\n      const loading = this.$vs.loading({\n        color: \"success\",\n      });\n\n      let data_envio = [];\n\n      this.lineas.forEach((element) => {\n        const is_extemporaneo =\n            element.fecha == this.admisionData.fechaExtemporaneo;\n        let obj = {\n          descripcion: \"ADMISION UNAP\",\n          monto: element.monto,\n          num_ticket: element.num_operacion,\n          fecha: element.fecha,\n          dni: element.num_doc,\n          nombre: element.nombre,\n          sede: this.get_auth.group,\n          monto_full: element.monto_full,\n          is_extemporaneo: is_extemporaneo,\n        };\n\n        data_envio.push(obj);\n      });\n\n      try {\n        const {data} = await axios.post(\"post_pagos_banko/\", data_envio);\n\n        this.lineas_existentes = data.data_existente;\n        this.lineas.forEach((element, index) => {\n          let indice = this.lineas_existentes.findIndex(\n              (item) => item.num_ticket == element.num_operacion\n          );\n          if (indice > -1) {\n            this.lineas[index].repetido = true;\n          }\n        });\n\n        if (data.length <= 0) {\n          this.$vs.notification({\n            title: \"Subir al servidor\",\n            text: \"No se pudo subir los datos! ðŸ˜¢\",\n            color: \"danger\",\n          });\n          return;\n        }\n\n        this.$vs.notification({\n          title: \"Subir al servidor\",\n          text: \"Los datos se subieron correctamente! ðŸ˜Ž\",\n          color: \"success\",\n        });\n      } catch (error) {\n        this.$vs.notification({\n          title: \"Subir al servidor\",\n          text: \"OcurriÃ³ un problema al subir los datos! ðŸ˜¢\",\n          color: \"danger\",\n        });\n      } finally {\n        loading.close();\n      }\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped></style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RegistroPago.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RegistroPago.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./RegistroPago.vue?vue&type=template&id=89a27926&scoped=true&\"\nimport script from \"./RegistroPago.vue?vue&type=script&lang=js&\"\nexport * from \"./RegistroPago.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"89a27926\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}
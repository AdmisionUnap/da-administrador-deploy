(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d43c7"],{"5fbb":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"flex flex-col"},[e("div",{staticClass:"flex"},["administrador"==t.get_auth.group?e("div",{staticClass:"flex"},[e("vs-button",{staticClass:"focus:outline-none",on:{click:function(e){return t.set_pagos()}}},[t._v(" Mostrar Todos los Registros ")]),e("vs-button",{staticClass:"focus:outline-none",on:{click:function(e){return t.agregar_nuevos_pagos()}}},[t._v(" Agregar Nuevos Registros ")])],1):t._e(),e("vs-button",{staticClass:"focus:outline-none",attrs:{danger:""},on:{click:function(e){t.item_selected={},t.dialog=!0}}},[t._v(" Pagos Exonerados ")])],1),t.mostrar?t._e():e("div",{staticClass:"flex flex-col lg:flex-row justify-between p-3 shadow-lg"},[e("div",[e("p",[t._v("Importar")]),e("input",{staticClass:"mt-3",attrs:{type:"file",accept:".txt"},on:{change:t.read_txt}})]),t.lineas.length>0?e("div",[e("h1",{staticClass:"font-medium text-3xl text-gray-300"},[t._v(" Dia: "+t._s(t.lineas[0].fecha)+" ")])]):t._e(),e("div",{staticClass:"mt-3 lg:mt-0"},[e("vs-button",{attrs:{square:""},on:{click:t.subirPagos}},[e("i",{staticClass:"fas fa-arrow-up mr-2"}),t._v(" Subir pagos ")])],1)])]),e("list",{attrs:{dataList:t.lineas,countExist:t.lineas_existentes.length,actualizar:t.actualizar},on:{edit:t.edit,actualizado:function(e){t.actualizar=!1}}}),e("add",{attrs:{dialog:t.dialog,item_selected:t.item_selected},on:{closedialog:t.close_dialog,actualizar:function(e){t.actualizar=!0}}})],1)},a=[],o=(s("14d9"),s("be3b"));const n=()=>s.e("chunk-2d0dd4cc").then(s.bind(null,"8196")),l=()=>s.e("chunk-2d221896").then(s.bind(null,"cb89"));var c={components:{List:n,Add:l},data(){return{lineas:[],lineas_existentes:[],mostrar:!0,item_selected:{},dialog:!1,actualizar:!1,admisionData:{},is_extemporaneo:!1}},computed:{get_auth(){return this.$store.getters["auth/get_auth"]},SedeText(){return"sede"==this.get_auth.group?this.get_auth.username:""}},async mounted(){await this.set_pagos(),this.getAdmision()},methods:{async getAdmision(){const{data:t}=await o["a"].get("admision");this.admisionData=t[0];const{fechaExtemporaneo:e}=this.admisionData,s=Date().now;e==s&&(this.is_extemporaneo=!0)},refresh_reactivo(){this.lineas=this.$store.getters["pago/get_pago"]},close_dialog(){this.dialog=!1,this.item_selected={}},edit(t){this.item_selected=null,this.item_selected=t,this.dialog=!0},agregar_nuevos_pagos(){this.lineas=[],this.lineas_existentes=[],this.mostrar=!1},async set_pagos(){try{this.mostrar=!0,this.lineas=[],this.lineas_existentes=[],await this.$store.dispatch("pago/set_pago",{sede:this.SedeText}),this.refresh_reactivo()}catch(t){}},async read_txt(t){const e=this.$vs.loading({color:"success"});try{const s=()=>new Promise(e=>{let s=t.target,i=new FileReader;i.onload=function(){let t=i.result;e(t)},i.readAsText(s.files[0])});await s().then(t=>{let e,s,i,a,o,n,l;this.lineas=[],e=s=i=a=o=n=l="";let c=t.split("\n");c.length<=0?this.$vs.notification({title:"Cargar Archivo de Texto",text:"El txt no tiene datos! ðŸ˜¢",color:"warning"}):c.forEach(t=>{o=t.slice(35,43);const c=parseInt(t.slice(112,113));s=t.slice(47,62),s=s.trim(),s=s.slice(7,15);const r=t.slice(98,101),d=["986","987"];if(574===parseInt(o)&&2===c){e=t.slice(25,27),i=t.slice(79,87);const o=i.slice(0,4),c=i.slice(4,6),u=i.slice(6,8);i=`${o}-${c}-${u}`,l=t.slice(18,25),a=t.slice(62,77);let h=0;h=a.slice(13,15),a=a.slice(1,13),a=parseFloat(`${a}.${h}`),n=t.slice(121,156),n=n.trim(),n=n.split(" ");let g=n.filter(t=>{if(t.length>0)return t});n="",g.forEach(t=>{n+=t.trim()+" "}),n=n.trim(),d.includes(r)&&(l=l.slice(1,7)),this.lineas.push({tipo_doc:e,num_doc:s,fecha:i,monto:a,nombre:n,num_operacion:l,repetido:!1,is_exonerado:!1,documento_referencial:"",monto_full:a})}})})}catch(s){}finally{e.close(),this.lineas_existentes=[]}},async subirPagos(){if(this.lineas.length<=0)return void this.$vs.notification({title:"Subir al servidor",text:"No existen datos! ðŸ˜¢",color:"danger"});const t=this.$vs.loading({color:"success"});let e=[];this.lineas.forEach(t=>{const s=t.fecha==this.admisionData.fechaExtemporaneo;let i={descripcion:"ADMISION UNAP",monto:t.monto,num_ticket:t.num_operacion,fecha:t.fecha,dni:t.num_doc,nombre:t.nombre,sede:this.get_auth.group,monto_full:t.monto_full,is_extemporaneo:s};e.push(i)});try{const{data:s}=await o["a"].post("post_pagos_banko/",e);if(this.lineas_existentes=s.data_existente,this.lineas.forEach((t,e)=>{let s=this.lineas_existentes.findIndex(e=>e.num_ticket==t.num_operacion);s>-1&&(this.lineas[e].repetido=!0)}),s.length<=0)return void this.$vs.notification({title:"Subir al servidor",text:"No se pudo subir los datos! ðŸ˜¢",color:"danger"});this.$vs.notification({title:"Subir al servidor",text:"Los datos se subieron correctamente! ðŸ˜Ž",color:"success"})}catch(s){this.$vs.notification({title:"Subir al servidor",text:"OcurriÃ³ un problema al subir los datos! ðŸ˜¢",color:"danger"})}finally{t.close()}}}},r=c,d=s("2877"),u=Object(d["a"])(r,i,a,!1,null,"30ec7540",null);e["default"]=u.exports}}]);
//# sourceMappingURL=chunk-2d0d43c7.bd1671ac.js.map